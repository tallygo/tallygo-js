<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>TallyGo Current location animation example</title>
    <meta name="description" content="TallyGo Current Location animation">
    <meta name="author" content="TallyGo">
    <script src="../node_modules/mapbox-gl/dist/mapbox-gl-dev.js"></script>
    <link rel="stylesheet" media="screen" href="../node_modules/mapbox-gl/dist/mapbox-gl.css" />
    <script src="../dist/browser.js"></script>
  </head>
  <body>
    <div id="tallygo-map"></div>
    <script>
      const tallygo = TallyGo.configure({
        apiToken: '22a2db381ba59ca2b4be2d21cea456e7',
        map: { navPosition: 'top-left' },
        // TODO: Remove the need to set the request apiUrl if it isn't used
        request: { apiUrl: 'https://api.tallygo.com/v1/route' }
      })
      const animationOptions = {
        vehicleIcon: 'car-taxi',
        animationSteps: 100,
        panMap: true,
        wsUrl: 'ws://localhost:3200'
      }
      const vehicleAnimation = new TallyGo.VehicleAnimation(tallygo.map, animationOptions)
      vehicleAnimation.map.glMap.loadImage('../images/car-taxi.png', function(error, image) {
        if (error) throw error;
        vehicleAnimation.map.glMap.addImage('car-taxi', image)
      })
      vehicleAnimation.webSocket.onopen = function() { console.log("socket is open") }
      vehicleAnimation.webSocket.onclose = function() { console.log("Connection is closed...") }
      vehicleAnimation.animate() // load the map and listen for location updates.
    </script>
  </body>
</html>
